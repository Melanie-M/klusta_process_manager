FileBase	animal001_2015_06_02_09_33
ElecNo	3
UseFeatures	
DropLastNFeatures	0
UseDistributional	1
MaskStarts	500
MinClusters	100
MaxClusters	110
MaxPossibleClusters	1000
nStarts	1
StartCluFile	
SplitEvery	40
SplitFirst	20
PenaltyK	0.000000
PenaltyKLogN	1.000000
Subset	1
FullStepEvery	20
MaxIter	10000
RandomSeed	1
Debug	0
SplitInfo	1
Verbose	1
DistDump	0
DistThresh	6.907755
ChangedThresh	0.050000
Log	1
SaveTempCluEveryIter	0
Screen	1
PriorPoint	1
SaveSorted	0
SaveCovarianceMeans	0
UseMaskedInitialConditions	0
AssignToFirstClosestMask	0
RamLimitGB	0.000000
AlwaysSplitBimodal	0
PointsForClusterMask	10.000000
MinMaskOverlap	0.000000
help	0
help	0
Starting KlustaKwik. Version: 0.3.0-nogit
Setting RAM limit to total physical memory, 15.61 GB.
-------------------------------------------------------------------------
Using Distributional EM with Maskstarts
NOTE: Maskstarts overides above values of MinClusters and MaxClusters                 
MinClusters = 500 
MaxClusters = 500 
 
Expected memory usage by array (largest first):

Array Cov will use between 0.00 and 0.01 GB.
- 8 bytes per element (scalar), 625000 elements when full.
- Memory usage scales as MaxPossibleClusters*nDims*nDims.
Array LogP will use between 0.00 and 0.00 GB.
- 8 bytes per element (scalar), 130000 elements when full.
- Memory usage scales as MaxPossibleClusters*nPoints.
Array AllVector2Mean will use between 0.00 and 0.00 GB.
- 8 bytes per element (scalar), 3250 elements when full.
- Memory usage scales as nPoints*nDims.
Array CorrectionTerm will use between 0.00 and 0.00 GB.
- 8 bytes per element (scalar), 3250 elements when full.
- Memory usage scales as nPoints*nDims.
Array Data will use between 0.00 and 0.00 GB.
- 2 bytes per element (data_int), 3250 elements when full.
- Memory usage scales as nPoints*nDims.
Array CharFloatMasks will use between 0.00 and 0.00 GB.
- 1 bytes per element (char), 3250 elements when full.
- Memory usage scales as nPoints*nDims.

Note that nPoints=130, nDims=25, MaxPossibleClusters=1000
Total memory usage will be between 0.00 and 0.02 GB.
RAM limit is set at 15.61 GB.
----------------------------------------------------------
Loaded 130 data points of dimension 25.
MEMO: A lower score indicates a better clustering 
 Masked EM: Computing Noise Means and Variances 
 -----------------------------------------
Starting from 500 clusters...
------ Clustering full data set of 130 points ------
Starting initial clusters from distinct float masks 
 Not enough masks (30) to generate starting clusters (500), so starting with (31) clusters instead.
Assigned 31 initial classes from 30 unique masks.
Deleting Class 4 (1 points): Lose 31.139419 but Gain 755.602363
Iteration 0F (0.012661 sec): 30 clusters
  Score: Raw -2506.834979 + Penalty 8126.281399 = 5619.446420
  nChanged 46
Deleting Class 17 (1 points): Lose 25.263750 but Gain 670.374698
Iteration 1F (0.016090 sec): 24 clusters
  Score: Raw -2729.594666 + Penalty 7894.973497 = 5165.378831
  nChanged 13
Deleting Class 5 (1 points): Lose 1.314387 but Gain 755.602363
Iteration 2F (0.019357 sec): 23 clusters
  Score: Raw -2777.968475 + Penalty 7485.324104 = 4707.355629
  nChanged 2
Deleting Class 7 (1 points): Lose 23.344364 but Gain 625.444492
Iteration 3Q (0.022172 sec): 22 clusters
  Score: Raw -2766.825672 + Penalty 6938.544046 = 4171.718374
  nChanged 3
Deleting Class 23 (1 points): Lose 8.383975 but Gain 601.014858
Iteration 4Q (0.024997 sec): 21 clusters
  Score: Raw -2784.228135 + Penalty 6418.896510 = 3634.668376
  nChanged 1
Deleting Class 8 (1 points): Lose 23.318123 but Gain 583.325329
Iteration 5Q (0.027700 sec): 20 clusters
  Score: Raw -2765.620776 + Penalty 5868.559108 = 3102.938332
  nChanged 2
Deleting Class 19 (1 points): Lose 8.149850 but Gain 521.711101
Iteration 6Q (0.030320 sec): 19 clusters
  Score: Raw -2760.297380 + Penalty 5349.005187 = 2588.707806
  nChanged 1
Deleting Class 27 (1 points): Lose 21.924300 but Gain 496.522199
Iteration 7Q (0.032884 sec): 18 clusters
  Score: Raw -2745.610318 + Penalty 4997.603727 = 2251.993409
  nChanged 1
Deleting Class 9 (2 points): Lose 10.632537 but Gain 417.196883
Iteration 8Q (0.035336 sec): 17 clusters
  Score: Raw -2747.493051 + Penalty 4599.781214 = 1852.288164
  nChanged 2
Deleting Class 30 (1 points): Lose 20.962999 but Gain 367.372531
Iteration 9Q (0.087179 sec): 16 clusters
  Score: Raw -2735.474826 + Penalty 4231.196424 = 1495.721598
  nChanged 1
Deleting Class 25 (3 points): Lose 28.893069 but Gain 364.235750
Iteration 10Q (0.089523 sec): 15 clusters
  Score: Raw -2715.918752 + Penalty 3868.451900 = 1152.533148
  nChanged 4
Deleting Class 28 (2 points): Lose 33.158952 but Gain 351.401460
Iteration 11Q (0.091717 sec): 14 clusters
  Score: Raw -2701.369581 + Penalty 3531.634531 = 830.264949
  nChanged 2
Deleting Class 18 (4 points): Lose 13.841128 but Gain 318.659880
Iteration 12Q (0.093841 sec): 13 clusters
  Score: Raw -2718.794270 + Penalty 3361.190063 = 642.395792
  nChanged 5
Deleting Class 16 (5 points): Lose 12.874212 but Gain 314.169605
Iteration 13Q (0.095913 sec): 12 clusters
  Score: Raw -2719.710154 + Penalty 3073.186265 = 353.476111
  nChanged 5
Deleting Class 29 (2 points): Lose 9.297769 but Gain 283.029949
Iteration 14Q (0.097923 sec): 11 clusters
  Score: Raw -2721.454689 + Penalty 2810.936511 = 89.481823
  nChanged 3
Deleting Class 11 (3 points): Lose 11.260288 but Gain 277.697163
Iteration 15Q (0.099886 sec): 10 clusters
  Score: Raw -2727.155050 + Penalty 2543.506830 = -183.648220
  nChanged 3
Deleting Class 13 (3 points): Lose 11.837541 but Gain 276.749594
Iteration 16Q (0.101747 sec): 9 clusters
  Score: Raw -2724.842490 + Penalty 2281.424303 = -443.418187
  nChanged 3
Deleting Class 15 (5 points): Lose 18.452565 but Gain 256.390320
Iteration 17Q (0.103611 sec): 8 clusters
  Score: Raw -2712.296785 + Penalty 2028.133746 = -684.163039
  nChanged 5
Deleting Class 22 (2 points): Lose 30.822678 but Gain 259.822252
Iteration 18Q (0.105437 sec): 7 clusters
  Score: Raw -2702.542742 + Penalty 1772.970510 = -929.572232
  nChanged 2
Deleting Class 21 (4 points): Lose 17.818567 but Gain 201.362826
Iteration 19Q (0.107112 sec): 6 clusters
  Score: Raw -2704.973123 + Penalty 1574.027003 = -1130.946120
  nChanged 4
Writing temp clu file 
Because OldScore, -929.572232, is greater than current (better) Score,-1130.946120 
 Compute initial score before splitting:   Score: Raw -2704.973123 + Penalty 1574.027003 = -1130.946120

 Trying to split cluster 2 (56 points) 
	SP: Assigned 2 initial classes randomly.
		SP:Iteration 0F (0.116782 sec): 2 clusters
  Score: Raw -1492.693341 + Penalty 339.519035 = -1153.174306
  nChanged 0
	SP: Assigned 3 initial classes randomly.
		SP:Iteration 0F (0.117751 sec): 3 clusters
  Score: Raw -1499.223929 + Penalty 677.726617 = -821.497312
  nChanged 3
		SP:Iteration 1F (0.118630 sec): 3 clusters
  Score: Raw -1510.542185 + Penalty 677.726617 = -832.815568
  nChanged 0

 Trying to split cluster 3 (22 points) 
	SP: Assigned 2 initial classes randomly.
		SP:Iteration 0F (0.119661 sec): 2 clusters
  Score: Raw -521.388473 + Penalty 116.900386 = -404.488087
  nChanged 0
	SP: Assigned 3 initial classes randomly.
		SP:Iteration 0F (0.120257 sec): 3 clusters
  Score: Raw -471.896750 + Penalty 252.548725 = -219.348025
  nChanged 6
		SP:Iteration 1F (0.120838 sec): 3 clusters
  Score: Raw -513.592480 + Penalty 294.910189 = -218.682291
  nChanged 1
		SP:Iteration 2F (0.121418 sec): 3 clusters
  Score: Raw -514.962984 + Penalty 294.910189 = -220.052795
  nChanged 0

 Trying to split cluster 6 (42 points) 
	SP: Assigned 2 initial classes randomly.
		SP:Iteration 0F (0.122640 sec): 2 clusters
  Score: Raw -883.323264 + Penalty 136.973422 = -746.349841
  nChanged 0
	SP: Assigned 3 initial classes randomly.
		SP:Iteration 0F (0.123365 sec): 3 clusters
  Score: Raw -869.073555 + Penalty 313.362473 = -555.711083
  nChanged 7
		SP:Iteration 1F (0.124088 sec): 3 clusters
  Score: Raw -887.759167 + Penalty 326.006390 = -561.752777
  nChanged 4
		SP:Iteration 2F (0.124792 sec): 3 clusters
  Score: Raw -840.554750 + Penalty 136.973422 = -703.581328
  nChanged 9
		SP:Iteration 3F (0.125456 sec): 2 clusters
  Score: Raw -883.323264 + Penalty 136.973422 = -746.349841
  nChanged 0
  Score: Raw -2823.844833 + Penalty 1574.027003 = -1249.817830

Splitting cluster 6 changes total score from -1130.946120 to -1249.817830

 So it's getting split into cluster 1.

 Trying to split cluster 20 (1 points) 
	SP: Assigned 2 initial classes randomly.
		SP:Iteration 0F (0.170309 sec): 2 clusters
  Score: Raw -19.399665 + Penalty 0.000000 = -19.399665
  nChanged 0
	SP: Assigned 3 initial classes randomly.
		SP:Iteration 0F (0.213016 sec): 2 clusters
  Score: Raw -19.399665 + Penalty 0.000000 = -19.399665
  nChanged 0

 Trying to split cluster 26 (3 points) 
	SP: Assigned 2 initial classes randomly.
		SP:Iteration 0F (0.219356 sec): 2 clusters
  Score: Raw -71.844881 + Penalty 33.751701 = -38.093180
  nChanged 0
	SP: Assigned 3 initial classes randomly.
		SP:Iteration 0F (0.219900 sec): 2 clusters
  Score: Raw -71.844881 + Penalty 33.751701 = -38.093180
  nChanged 0
Deleting Class 26 (3 points): Lose 13.093155 but Gain 149.540988
Iteration 20F (0.221812 sec): 5 clusters
  Score: Raw -2700.811704 + Penalty 1422.563461 = -1278.248243
  nChanged 3
Deleting Class 3 (22 points): Lose 86.176985 but Gain 184.085682
Iteration 21Q (0.223378 sec): 4 clusters
  Score: Raw -2622.989396 + Penalty 1229.556888 = -1393.432508
  nChanged 22
Deleting Class 20 (1 points): Lose 2.872307 but Gain 24.596039
Iteration 22F (0.224927 sec): 3 clusters
  Score: Raw -2691.886741 + Penalty 1206.475660 = -1485.411081
  nChanged 2
Iteration 23Q (0.226163 sec): 3 clusters
  Score: Raw -2694.663992 + Penalty 1206.475660 = -1488.188332
  nChanged 0
Iteration 24F (0.227432 sec): 3 clusters
  Score: Raw -2694.663992 + Penalty 1206.475660 = -1488.188332
  nChanged 0
Compute initial score before splitting:   Score: Raw -2694.663992 + Penalty 1206.475660 = -1488.188332

 Trying to split cluster 2 (58 points) 
	SP: Assigned 2 initial classes randomly.
		SP:Iteration 0F (0.231843 sec): 2 clusters
  Score: Raw -1535.855014 + Penalty 338.664004 = -1197.191010
  nChanged 0
	SP: Assigned 3 initial classes randomly.
		SP:Iteration 0F (0.232811 sec): 3 clusters
  Score: Raw -1550.178427 + Penalty 677.328007 = -872.850420
  nChanged 4
		SP:Iteration 1F (0.233696 sec): 3 clusters
  Score: Raw -1560.514745 + Penalty 677.008199 = -883.506546
  nChanged 1
		SP:Iteration 2Q (0.234586 sec): 3 clusters
  Score: Raw -1563.583438 + Penalty 677.008199 = -886.575239
  nChanged 0
		SP:Iteration 3F (0.235468 sec): 3 clusters
  Score: Raw -1563.583438 + Penalty 677.008199 = -886.575239
  nChanged 0

 Trying to split cluster 6 (66 points) 
	SP: Assigned 2 initial classes randomly.
		SP:Iteration 0F (0.238301 sec): 2 clusters
  Score: Raw -1369.344897 + Penalty 149.443939 = -1219.900958
  nChanged 0
	SP: Assigned 3 initial classes randomly.
		SP:Iteration 0F (0.239204 sec): 3 clusters
  Score: Raw -1354.573535 + Penalty 312.014422 = -1042.559113
  nChanged 13
		SP:Iteration 1F (0.240089 sec): 3 clusters
  Score: Raw -1374.354892 + Penalty 335.920592 = -1038.434301
  nChanged 7
		SP:Iteration 2F (0.240951 sec): 3 clusters
  Score: Raw -1375.251386 + Penalty 365.728920 = -1009.522466
  nChanged 6
		SP:Iteration 3F (0.241791 sec): 3 clusters
  Score: Raw -1376.881788 + Penalty 360.853066 = -1016.028722
  nChanged 3
		SP:Iteration 4Q (0.242606 sec): 3 clusters
  Score: Raw -1320.913393 + Penalty 535.301513 = -785.611880
  nChanged 8
		SP:Iteration 5F (0.243441 sec): 3 clusters
  Score: Raw -1375.683770 + Penalty 535.301513 = -840.382258
  nChanged 0
Time taken for this iteration:0.242064 seconds.
 500->3 Clusters: Score -1488.188332, best is 100000000000000005366162204393472.000000
THE BEST YET!

Main iterations: 25 (time per iteration =1.418440 ms)
Total iterations: 53 (time per iteration =0.669076 ms)

Def. Iteration metric 2:
Iteration_metric2 += (scalar)(nDims*nDims)*(scalar)(nPoints)
Iterations metric 2: 2797500.000000 (time per metric unit =12.675964ns)

Def. Iteration metric 3:
Iteration_metric3 += (scalar)(nDims*nDims)*(scalar)(nDims*nPoints)
Iterations metric 3: 69937500.000000 (time per metric unit=507.038542ps)

That took 0.035461 seconds.
